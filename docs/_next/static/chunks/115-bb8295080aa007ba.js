(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[115],{477:()=>{},995:(e,t,i)=>{"use strict";i.d(t,{A:()=>g});var n=i(7876),s=i(4232),o=i(1459);let a=JSON.parse('[{"x":24.5,"y":-12.357142857142858,"settlements":[0,3]},{"x":267.4,"y":-12.357142857142847,"settlements":[1,5]},{"x":480.275,"y":111.66071428571429,"settlements":[10,15]},{"x":586.7,"y":323,"settlements":[26,32]},{"x":480.25,"y":534.625,"settlements":[42,46]},{"x":267.4,"y":658.625,"settlements":[49,52]},{"x":24.5,"y":658.625,"settlements":[47,51]},{"x":-81.92500000000001,"y":446.9908536585366,"settlements":[33,38]},{"x":-81.95,"y":199,"settlements":[11,16]}]');var r=i(8210),d=i(4237),l=i(3976),x=i(4740),c=i(5870),m=i(6059),y=i(5770),u=i(7441),f=i(1198),h=i(3339),p=i(5334);class v extends s.Component{static get instance(){return this._instance}componentDidMount(){this.updateScale(),window.addEventListener("resize",this.updateScale)}componentWillUnmount(){window.removeEventListener("resize",this.updateScale)}render(){let{scale:e,mapState:t,materials:i,robberArea:s,sets:u,harbors:v}=this.state,{roads:g,settlements:E,cities:b}=u;return"loading"===t||0===v.length?(0,n.jsx)("div",{className:"h-100 flex justify-center items-center",children:(0,n.jsx)(p.A,{})}):(console.log("mapState",t),(0,n.jsx)("div",{className:"relative w-full h-full overflow-hidden",ref:this.outerRef,children:(0,n.jsx)("div",{className:"absolute",style:{left:"50%",top:"50%",transform:"translate(-50%, -50%) scale(".concat(e,")"),transformOrigin:"top left"},children:(0,n.jsx)("div",{ref:this.boardRef,className:"relative w-fit h-fit",children:(0,n.jsxs)("div",{style:{translate:"-215px -322.5px"},children:[Array.from(i.entries()).map(e=>{var i;let[a,{num:r,material:d}]=e,u="picking area"===t&&s!==a?"animate-pulse opacity-30 hover:opacity-75 hover:animate-none hover:scale-90 scale-95 transition-[transform,opacity] cursor-pointer z-10":"pointer-events-none";return(0,n.jsx)(x._,{onClick:()=>{console.log("picked area:",a),this.state.events.emit("picked area",a)},color:l.d.matsColors[d],className:(0,c.cn)("absolute",u),style:{animationDelay:"".concat(a/4,"s"),translate:"".concat(o[a].x,"px ").concat(o[a].y,"px")},children:(0,n.jsxs)("div",{className:"flex gap-2 items-center font-[Rubik] scale-85 font-bold text-2xl",children:[a===s?(0,n.jsxs)(y.m_,{children:[(0,n.jsx)(y.k$,{children:(0,n.jsx)(m.kzF,{className:"z-10",color:"white",size:26})}),(0,n.jsx)(y.ZI,{children:(0,n.jsx)("p",{children:"Robber"})})]}):null,(0,n.jsx)("p",{children:r}),(0,n.jsxs)(y.m_,{children:[(0,n.jsx)(y.k$,{children:null==(i=l.s[d])?void 0:i.call(l.s,{fill:"white",stroke:"white",color:"white",width:30,height:30})}),(0,n.jsx)(y.ZI,{children:(0,n.jsx)("p",{children:d})})]})]})},a)}),d.map((e,i)=>{let{x:s,y:o}=e,a=E.has(i)&&!b.has(i),r=a?f.lm[E.get(i)]:"#ffffff",d=a&&"picking vertex upgrade"!==t?"ff":"picking vertex"===t?"88":"00",l="".concat(r).concat(d);return(0,n.jsxs)("div",{"data-id":i,className:(0,c.cn)("z-2 absolute transition-transform","picking vertex"!==t||a?"pointer-events-none":"animate-pulse hover:scale-95 hover:animate-none cursor-pointer"),style:{translate:"".concat(s,"px ").concat(o,"px")},onClick:()=>{console.log("picked vertex:",i),this.state.events.emit("picked vertex",i)},children:[(0,n.jsx)(h.e2k,{color:l,className:"absolute top-0 left-0",size:30,style:{translate:"".concat(-15,"px ").concat(-15,"px")}}),f.jW.settlement({size:15,color:"#000000".concat(d),style:{translate:"".concat(-7.5,"px ").concat(-7.5,"px")},className:"absolute top-0 left-0"})]},i)}),d.map((e,i)=>{let{x:s,y:o}=e,a=b.has(i),r=a?"ff":"picking vertex upgrade"===t&&E.has(i)?"88":"00",d=a?f.lm[E.get(i)]:"#ffffff",l="".concat(d).concat(r);return(0,n.jsxs)("div",{"data-id":i,className:(0,c.cn)("z-2 absolute transition-transform","picking vertex upgrade"!==t||a?"pointer-events-none":"animate-pulse hover:scale-95 hover:animate-none cursor-pointer"),style:{translate:"".concat(s,"px ").concat(o,"px")},onClick:()=>{console.log("picked vertex upgrade:",i),this.state.events.emit("picked vertex upgrade",i)},children:[(0,n.jsx)(h.e2k,{color:l,className:"absolute top-0 left-0",size:30,style:{translate:"".concat(-15,"px ").concat(-15,"px")}}),f.jW.city({size:15,color:"#000000".concat(r),style:{translate:"".concat(-7.5,"px ").concat(-7.5,"px")},className:"absolute top-0 left-0"}),(0,n.jsx)("div",{})]},i)}),a.map((e,t)=>{let{x:i,y:s}=e,o=v[t],{icon:a,name:r}=f.Me[o],d=o<5?l.d.matsColors[r.toLocaleLowerCase()]+"ff":"#ffff";return(0,n.jsxs)(y.m_,{children:[(0,n.jsx)(y.k$,{asChild:!0,children:(0,n.jsxs)("div",{"data-id":t,className:(0,c.cn)("z-2 absolute opacity-50 hover:opacity-100 hover:scale-110 w-[33px] h-[33px] transition-[opacity,scale]"),style:{translate:"".concat(i-16.5,"px ").concat(s-16.5,"px")},onClick:()=>{console.log("picked vertex upgrade:",t),this.state.events.emit("picked vertex upgrade",t)},children:[(0,n.jsx)(h.e2k,{color:"#666",className:"absolute top-0 left-0 ",size:33}),(0,n.jsx)(h.e2k,{color:"var(--background)",className:"absolute top-0 left-0",size:30,style:{translate:"".concat(1.5,"px ",1.5,"px")}}),a({color:d,style:{translate:"".concat(9,"px ").concat(9,"px"),stroke:d,opacity:1,fill:d,width:15,height:15},className:"absolute top-0 left-0"}),(0,n.jsx)("div",{})]},t)}),(0,n.jsxs)(y.ZI,{children:[(0,n.jsxs)("div",{className:"flex justify-center gap-2 items-center",children:[a({color:d,width:"15",height:"15",stroke:d,fill:d,style:{translate:"0px -2px"}}),(0,n.jsxs)("h1",{className:"text-mid text-center font-[Rubik]",children:[r," Deal"]})]}),(0,n.jsx)("p",{className:"text-sm opacity-50 font-[Geist]",children:o<5?"Give 2 ".concat(r," For 1 Material"):"Give 3 of the Same Material For 1 Material"})]})]})}),(0,n.jsxs)("svg",{className:"absolute -top-[50px] -left-[400px] w-[1000px] h-[1000px]",children:[r.map((e,i)=>{let{from:s,to:o}=e,a=1e3*s.index+o.index,r=g.has(a),d=r?f.lm[g.get(a)]:"#ffffff",l=["picking edge","picking 2 edges"].includes(t),x="".concat(d).concat(r?"ff":l?"55":"00");return(0,n.jsx)("line",{stroke:x,className:l&&!r?"animate-pulse hover:animate-none cursor-pointer":"pointer-events-none",strokeWidth:5,x1:o.x+400,x2:s.x+400,y1:o.y+50,y2:s.y+50,onClick:()=>{console.log("picked edge:",i),this.state.events.emit("picked edge",s.index,o.index)}},i)}),a.flatMap((e,t)=>{let{x:i,y:s,settlements:o}=e,a="#666";return o.flatMap(e=>{let t=d[e],o=(e,n)=>({x:(n*i+e*t.x)/(e+n),y:(n*s+e*t.y)/(e+n)}),r=o(7,10),l=o(10,7);return[(0,n.jsx)("line",{className:"animate-pulse",stroke:a,strokeWidth:1,x1:r.x+400,x2:l.x+400,y1:r.y+50,y2:l.y+50},e),(0,n.jsx)("circle",{className:"animate-pulse",cx:l.x+400,cy:l.y+50,r:1/.7,fill:a,stroke:a,color:a})]})})]})]})})})}))}constructor(e){super(e),this.outerRef=(0,s.createRef)(),this.boardRef=(0,s.createRef)(),this.updateScale=()=>{var e,t;let i=null==(e=this.outerRef.current)?void 0:e.getBoundingClientRect(),n=null==(t=this.boardRef.current)?void 0:t.getBoundingClientRect();if(i&&n){let e=i.width/n.width,t=i.height/n.height;this.setState({scale:Math.min(e,t,1)})}},v._instance=this;let{materials:t,robberArea:i,ui:{mapState:n,events:o},prepareMapSets:a,harbors:r}=u.i.getState();this.state={...this.state,materials:t,robberArea:i,mapState:n,events:o,scale:1,sets:a(),harbors:r},u.i.subscribe(e=>{this.setState({materials:e.materials,robberArea:e.robberArea,mapState:e.ui.mapState,events:e.ui.events,sets:e.prepareMapSets(),harbors:e.harbors})})}}v._instance=null;let g=v},1352:(e,t,i)=>{"use strict";i.d(t,{p:()=>o});var n=i(7876);i(4232);var s=i(5870);function o(e){let{className:t,type:i,...o}=e;return(0,n.jsx)("input",{type:i,"data-slot":"input",className:(0,s.cn)("file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/0 dark:focus-visible:bg-input/10 border-input flex h-9 w-full min-w-0 rounded-md border bg-transparent px-3 py-1 text-base shadow-xs transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm","","aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",t),...o})}},1459:e=>{"use strict";e.exports=JSON.parse('[{"x":0,"y":0},{"x":141.9,"y":0},{"x":283.8,"y":0},{"x":-70.95,"y":123.75},{"x":70.95,"y":123.75},{"x":212.85,"y":123.75},{"x":354.75,"y":123.75},{"x":-141.9,"y":247.5},{"x":0,"y":247.5},{"x":141.9,"y":247.5},{"x":283.8,"y":247.5},{"x":425.7,"y":247.5},{"x":-70.95,"y":371.25},{"x":70.95,"y":371.25},{"x":212.85,"y":371.25},{"x":354.75,"y":371.25},{"x":0,"y":495},{"x":141.9,"y":495},{"x":283.8,"y":495}]')},1776:(e,t,i)=>{"use strict";i.d(t,{Q:()=>s,a:()=>n});var n=function(e){return e.INIT="i",e.STATUS="s",e.ROLL="r",e.MESSAGE="m",e.STOP_TURN="t",e.BUY_DEVCARD="bd",e.BUY_ROAD="br",e.BUY_SETTLEMENT="bs",e.BUY_CITY="bc",e.MOVE_ROBBER="mr",e.DROP_MATS="dp",e.DEV_YEAROFPLENTY="dyop",e.DEV_MONOPOL="dm",e.DEV_ROADS="dr",e.REQUEST_TRADES="rt",e.APPLY_TRADE="at",e.READY="rea",e}({}),s=function(e){return e.PLAYER_JOIN="pj",e.STOP="st",e.DISCONNECTED="dis",e.STATUS="s",e.INIT="i",e.TURN_DICE="t",e.MESSAGE="m",e.TURN_SWITCH="a",e.PLAYER_UPDATE="pu",e.BANK_UPDATE="bu",e.OTHER_UPDATE="ou",e.ACHIVEMENTS_UPDATE="ao",e.MOVE_ROBBER="mr",e.DEV_MONOPOL="dm",e.WIN="w",e.MATS_NOTIFICATION="mn",e.GET_TRADES="gt",e.READY="rea",e.START_GAME="sg",e}({})},2328:(e,t,i)=>{"use strict";function n(e){return Math.floor(Math.random()*e.length)}i.d(t,{O:()=>n})},2588:(e,t,i)=>{"use strict";i.d(t,{AM:()=>a,Wv:()=>r,hl:()=>d});var n=i(7876);i(4232);var s=i(1952),o=i(5870);function a(e){let{...t}=e;return(0,n.jsx)(s.bL,{"data-slot":"popover",...t})}function r(e){let{...t}=e;return(0,n.jsx)(s.l9,{"data-slot":"popover-trigger",asChild:!0,...t})}function d(e){let{className:t,align:i="center",sideOffset:a=4,...r}=e;return(0,n.jsx)(s.ZL,{children:(0,n.jsx)(s.UC,{"data-slot":"popover-content",align:i,sideOffset:a,className:(0,o.cn)("bg-accent text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 w-72 origin-(--radix-popover-content-transform-origin) rounded-md border p-4 shadow-md outline-hidden",t),...r})})}},3174:e=>{"use strict";e.exports=[10,0,10,10,10]},3246:(e,t,i)=>{"use strict";i.d(t,{t:()=>x});var n=i(7876),s=i(5870),o=i(4232),a=i(1892),r=i(5770),d=i(1198);function l(e){let{devs:t,colorize:i=!0,shadowed:o=!1}=e;return(0,n.jsx)(n.Fragment,{children:t.map((e,t)=>{let{color:a,name:l,icon:x}=d.n2[t],c=i?a:"#ffffff";return(0,n.jsxs)(r.m_,{children:[(0,n.jsx)(r.k$,{asChild:!0,children:(0,n.jsxs)("div",{className:(0,s.cn)("flex gap-2 items-center",e?"":"hidden"),children:[(0,n.jsx)("p",{className:"text-lg scale-90 font-[Rubik]",children:e}),x({stroke:c,opacity:.65,fill:c,width:20,height:20,style:o?{filter:"drop-shadow(0px 0px 2px ".concat(c,") drop-shadow(0px 0px 50px ").concat(c,") drop-shadow(0px 0px 50px ").concat(c,")")}:{}})]})}),(0,n.jsx)(r.ZI,{children:(0,n.jsx)("p",{children:l})})]},t)})})}class x extends o.Component{static get instance(){return this._instance}wake(e){let{mats:t=[0,0,0,0,0],devs:i=[0,0,0,0,0]}=e;this.state.hidden?this.setState(e=>({...e,mats:t,devs:i,hidden:!1})):(this.setState(e=>({...e,hidden:!0})),setTimeout(()=>{this.setState(e=>({...e,mats:t,devs:i,hidden:!1}))},70))}render(){let{hidden:e,mats:t,devs:i}=this.state;return(0,n.jsx)("div",{onAnimationEnd:()=>{this.setState(e=>({...e,hidden:!0}))},ref:this.containerRef,className:(0,s.cn)("z-20 absolute left-[50%] -translate-x-[50%] -translate-y-[150%]",e&&" pointer-events-none"),style:{},children:(0,n.jsxs)("div",{className:(0,s.cn)("opacity-0 flex gap-2"),style:{animation:e?"":"hop 1.5s cubic-bezier(0,.96,1,1)"},children:[(0,n.jsx)(a.G,{colorize:!0,shadowed:!0,mats:t}),(0,n.jsx)(l,{colorize:!0,shadowed:!0,devs:i})]})})}constructor(){super({}),this.containerRef=(0,o.createRef)(),this.state={...this.state,mats:[0,0,0,0,0],hidden:!0,devs:[0,0,0,0,0]},x._instance=this}}x._instance=null},4237:e=>{"use strict";e.exports=JSON.parse('[{"x":75,"y":-8},{"x":216.9,"y":-8},{"x":358.8,"y":-8},{"x":4,"y":34},{"x":146,"y":34},{"x":287.9,"y":34},{"x":429.8,"y":34},{"x":4,"y":116},{"x":146,"y":116},{"x":287.9,"y":116},{"x":429.8,"y":116},{"x":-66.95,"y":158},{"x":75,"y":158},{"x":216.9,"y":158},{"x":358.8,"y":158},{"x":500.75,"y":158},{"x":-66.95,"y":240},{"x":75.05,"y":240},{"x":216.95,"y":240},{"x":358.85,"y":240},{"x":500.75,"y":240},{"x":-137.9,"y":282},{"x":4.049999999999997,"y":282},{"x":145.95,"y":282},{"x":287.85,"y":282},{"x":429.75,"y":282},{"x":571.7,"y":282},{"x":-137.9,"y":364},{"x":4.099999999999994,"y":364},{"x":146,"y":364},{"x":287.9,"y":364},{"x":429.8,"y":364},{"x":571.7,"y":364},{"x":-66.9,"y":406},{"x":75,"y":406},{"x":216.9,"y":406},{"x":358.8,"y":406},{"x":500.7,"y":406},{"x":-66.95,"y":488},{"x":75.05,"y":488},{"x":216.95,"y":488},{"x":358.85,"y":488},{"x":500.75,"y":488},{"x":4.049999999999997,"y":528},{"x":145.95,"y":528},{"x":287.85,"y":528},{"x":429.75,"y":528},{"x":4,"y":612},{"x":146,"y":612},{"x":287.9,"y":612},{"x":429.8,"y":612},{"x":75,"y":652},{"x":216.9,"y":652},{"x":358.8,"y":652}]')},4740:(e,t,i)=>{"use strict";i.d(t,{_:()=>r});var n=i(7876),s=i(4232),o=i(9749);let a=0;function r(e){let{color:t,children:i,...r}=e,[d]=(0,s.useState)(a++);return(0,n.jsx)("div",{className:"relative ",...r,children:(0,n.jsxs)("div",{style:{transition:"translate .1s"},children:[(0,n.jsx)("div",{className:"absolute z-2 top-[50%] left-[50%] -translate-[50%]",children:i}),(0,n.jsx)(o.Fdf,{style:{translate:"".concat(2.5,"px ").concat(2.5,"px")},className:"z-1 absolute",color:"var(--sidebar)",size:145,opacity:.95}),(0,n.jsx)(o.Fdf,{color:t,size:150,className:"absolute",style:{transition:"filter .1s"},filter:"drop-shadow(0px ".concat(20,"px ").concat(t,"5f)")}),(0,n.jsx)(o.Fdf,{color:t,size:150,className:"animate-pulse",style:{animationDelay:"".concat(d/3,"s")},filter:"drop-shadow(0px 0px 25px ".concat(t,"7f)")})]})})}},5334:(e,t,i)=>{"use strict";i.d(t,{A:()=>o});var n=i(7876),s=i(6763);function o(){return(0,n.jsx)(s.A,{className:"animate-spin"})}},6463:(e,t,i)=>{"use strict";i.d(t,{A:()=>n});let n={CODE_PREFIX:"itaylayzer-catan.io-",PEER_DEBUG_LEVEL:0,PEER_SECURE:!0,PEER_SERVER_PORT:443,PEER_SERVER_HOST:"peer.itaylayzer.freeddns.org"}},7041:(e,t,i)=>{"use strict";i.d(t,{$:()=>d});var n=i(7876);i(4232);var s=i(2987),o=i(9518),a=i(5870);let r=(0,o.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",{variants:{variant:{default:"bg-primary text-primary-foreground shadow-xs hover:bg-primary/90",destructive:"bg-destructive text-white shadow-xs hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"border bg-transparent shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-transparent dark:border-input dark:hover:bg-input/20",secondary:"bg-secondary text-secondary-foreground shadow-xs hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2 has-[>svg]:px-3",sm:"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5",lg:"h-10 rounded-md px-6 has-[>svg]:px-4",icon:"size-9"}},defaultVariants:{variant:"default",size:"default"}});function d(e){let{className:t,variant:i,size:o,asChild:d=!1,...l}=e,x=d?s.DX:"button";return(0,n.jsx)(x,{"data-slot":"button",className:(0,a.cn)(r({variant:i,size:o,className:t})),...l})}},7350:(e,t,i)=>{"use strict";i.d(t,{_:()=>a,a:()=>r});var n=i(896),s=i(6463),o=i(2328);function a(e){return n.SHA256(s.A.CODE_PREFIX+e).toString(n.enc.Hex)}function r(){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789",t="";for(let i=0;i<6;i++){let i=(0,o.O)(e);t+=e[i]}return t}},7441:(e,t,i)=>{"use strict";i.d(t,{i:()=>f});var n=i(995),s=i(3976),o=i(3246),a=i(1776),r=i(4258);function d(e,t,i){let n=(0,r.XU)(e,t);for(;i.includes(n);)n=(0,r.XU)(e,t);return n}var l=i(9333);class x{on(e,t){this.events[e]||(this.events[e]=new Set),this.events[e].add(t)}once(e,t){var i=this;let n=function(){for(var s=arguments.length,o=Array(s),a=0;a<s;a++)o[a]=arguments[a];t(...o),i.off(e,n)};this.on(e,n)}off(e,t){this.events[e]&&this.events[e].delete(t)}emit(e){for(var t=arguments.length,i=Array(t>1?t-1:0),n=1;n<t;n++)i[n-1]=arguments[n];console.log("fired:",JSON.stringify(e)),this.events[e]&&this.events[e].forEach(e=>e(...i))}constructor(){this.events={}}}var c=i(8106),m=i(7492),y=i(3174);let u={longestRoad:-1,largestArmy:-1,robberArea:-1,harbors:[],materials:new Map,bank:{devcards:[0,0,0,0,0],materials:[0,0,0,0,0]},client:{id:-1},onlines:new Map,local:{knightUsed:0,materials:[...m],devcards:[...y],roads:[],cities:[],settlements:[],victoryPoints:0,color:0,name:"",amounts:{city:4,road:15,settlement:5},maxRoad:0,ready:!1},turnId:0,dices:void 0,ui:{gameStarted:!1,mapState:"picking area",dicesState:"ready",events:new x}},f=(0,c.v)((e,t)=>({...u,set:e,setSocket(i){let r=t=>{e(e=>({ui:{...e.ui,dicesState:t}}))};i.on(a.Q.INIT,n=>{let{harbors:o,materials:a,bank:r,id:d,robberArea:l,onlines:x}=n;console.log("client INIT id",d);let c=new Map(a.map(e=>{let[t,{num:i,material:n}]=e;return[t,{num:i,material:s.d.matsNaming[n]}]}));e(e=>({harbors:o,materials:c,robberArea:l,bank:{devcards:r.devcards,materials:r.materials},client:{socket:i,id:d},local:{...e.local,color:d}})),requestAnimationFrame(function i(){t().harbors.length>0?e(e=>({ui:{...e.ui,mapState:"ready"}})):requestAnimationFrame(i)});let{onlines:m}=t();for(let e of(console.log("onlines.clear before",m),m.forEach((e,t)=>m.delete(t)),console.log("onlines.clear after",m),x)){let{devcards:t,id:i,materials:n,name:s}=e;console.log("client player INIT",e),m.set(i,{devcards:t,color:i,materials:n,name:s,cities:[],knightUsed:0,maxRoad:0,roads:[],settlements:[],victoryPoints:0,ready:!1})}e({onlines:new Map(m)})}),i.on(a.Q.READY,i=>{let[n,s]=i;if(n===t().local.color)e(e=>({local:{...e.local,ready:s}}));else{let{onlines:i}=t(),o=i.get(n);o&&(o.ready=s,i.set(n,o),e({onlines:new Map(i)}))}}),i.on(a.Q.DISCONNECTED,i=>{let{onlines:n}=t();n.delete(i)&&e({onlines:new Map(n)})}),i.on(a.Q.STOP,()=>{t().ui.events.emit("stop midgame")}),i.on(a.Q.STATUS,e=>{let i=["unkown error","max players amount has reached his limit","game has started"][e];t().ui.events.emit("status",i)}),i.on(a.Q.START_GAME,()=>{e(e=>({ui:{...e.ui,gameStarted:!0}}))}),i.on(a.Q.PLAYER_JOIN,i=>{console.log("client player PLAYER_JOIN",i);let{onlines:n}=t(),{devcards:s,id:o,materials:a,name:r}=i;n.set(o,{devcards:s,color:o,materials:a,name:r,cities:[],knightUsed:0,maxRoad:0,roads:[],settlements:[],victoryPoints:0,ready:!1}),e({onlines:new Map(n)})}),i.on(a.Q.TURN_DICE,n=>{let{dices:s,addons:x}=n;r("rolling"),e({dices:[d(1,6,[s[0]]),d(1,6,[s[1]])]}),setTimeout(()=>{e({dices:s})},100),t().ui.events.once("dices finished",()=>{x.forEach(e=>{let{from:i,mats:n}=e;if(i===t().local.color)(0,l.A)(t().local.materials).sameSize.add(n),t().ui.events.emit("render decks"),(0,l.A)(n).sum()>0&&o.t.instance.wake({mats:n});else{let e=t().onlines.get(i);e&&(e.materials+=(0,l.A)(n).sum())}}),s[0]+s[1]===7&&(t().turnId===t().local.color&&(e(e=>({ui:{...e.ui,mapState:"picking area"}})),t().ui.events.once("picked area",e=>{t().ui.events.emit("dock 7 free"),i.emit(a.a.MOVE_ROBBER,{areaOffset:e,useDevcard:!1})})),(0,l.A)(t().local.materials).sum()>6&&(t().ui.events.emit("7"),t().ui.events.once("7 give",e=>{i.emit(a.a.DROP_MATS,e)}))),t().turnId===t().local.color?r("mine"):r("others")})}),i.on(a.Q.MATS_NOTIFICATION,e=>{let[t,i]=e;o.t.instance.wake({mats:t,devs:i})}),i.on(a.Q.WIN,e=>{let{id:i,players:n}=e;console.log("winner.client"),t().ui.events.emit("win",i,n)}),i.on(a.Q.MOVE_ROBBER,t=>{e({robberArea:t}),e(e=>({ui:{...e.ui,mapState:"ready"}}))}),i.on(a.Q.TURN_SWITCH,i=>{e({turnId:i}),r(t().turnId===t().local.color?"ready":"others")}),i.on(a.Q.PLAYER_UPDATE,i=>{var s;let o={...t().local};i.amounts&&(o.amounts=i.amounts),i.settlements&&(o.settlements=i.settlements),i.cities&&(o.cities=i.cities),i.roads&&(o.roads=i.roads),i.materials&&(o.materials=i.materials),i.devcards&&(o.devcards=i.devcards),i.maxRoad&&(o.maxRoad=i.maxRoad),i.knightUsed&&(o.knightUsed=i.knightUsed),o.victoryPoints=i.vp,e({local:o}),null==(s=n.A.instance)||s.forceUpdate()}),i.on(a.Q.BANK_UPDATE,t=>{e({bank:t})}),i.on(a.Q.DEV_MONOPOL,e=>{let{from:i,mat:n}=e;t().ui.events.emit("monopol show",i,n)}),i.on(a.Q.OTHER_UPDATE,i=>{let n=t().onlines.get(i.id);n.materials=i.materials,n.devcards=i.devcards,i.roads&&(n.roads=i.roads),i.cities&&(n.cities=i.cities),i.settlements&&(n.settlements=i.settlements),i.maxRoad&&(n.maxRoad=i.maxRoad),i.knightUsed&&(n.knightUsed=i.knightUsed),n.victoryPoints=i.vp,t().onlines.set(i.id,{...n}),e({onlines:new Map(t().onlines)})}),i.on(a.Q.ACHIVEMENTS_UPDATE,t=>{let{largestArmy:i,longestRoad:n}=t;e({largestArmy:i,longestRoad:n})}),i.on(a.Q.GET_TRADES,e=>{t().ui.events.emit("trade requests",e)}),i.emit(a.a.INIT,t().local.name),e({client:{socket:i,id:-1}})},prepareMapSets(){let{local:e,onlines:i}=t(),n=new Map,s=new Map,o=new Set;return[...Array.from(i.values()),e].flat().forEach(e=>{e.roads.forEach((t,i)=>{n.set(1e3*t[0]+t[1],e.color)}),e.settlements.forEach(t=>{s.set(t,e.color)}),e.cities.forEach(e=>{o.add(e)})}),{roads:n,settlements:s,cities:o}},resetToDefaults(){e(e=>({...u,onlines:new Map,materials:new Map,bank:{devcards:[0,0,0,0,0],materials:[0,0,0,0,0]},local:{...u.local,name:e.local.name}}))}}))},7492:e=>{"use strict";e.exports=[10,10,10,10,10]},8210:e=>{"use strict";e.exports=JSON.parse('[{"middle":{"x":75,"y":30},"from":{"x":75,"y":-8,"index":19},"to":{"x":4,"y":34,"index":22}},{"middle":{"x":75,"y":30},"from":{"x":75,"y":-8,"index":19},"to":{"x":146,"y":34,"index":23}},{"middle":{"x":216.9,"y":30},"from":{"x":216.9,"y":-8,"index":20},"to":{"x":146,"y":34,"index":23}},{"middle":{"x":216.9,"y":30},"from":{"x":216.9,"y":-8,"index":20},"to":{"x":287.9,"y":34,"index":24}},{"middle":{"x":358.8,"y":30},"from":{"x":358.8,"y":-8,"index":21},"to":{"x":287.9,"y":34,"index":24}},{"middle":{"x":358.8,"y":30},"from":{"x":358.8,"y":-8,"index":21},"to":{"x":429.8,"y":34,"index":25}},{"middle":{"x":4,"y":120},"from":{"x":4,"y":34,"index":22},"to":{"x":4,"y":116,"index":26}},{"middle":{"x":146,"y":120},"from":{"x":146,"y":34,"index":23},"to":{"x":146,"y":116,"index":27}},{"middle":{"x":287.9,"y":120},"from":{"x":287.9,"y":34,"index":24},"to":{"x":287.9,"y":116,"index":28}},{"middle":{"x":429.8,"y":120},"from":{"x":429.8,"y":34,"index":25},"to":{"x":429.8,"y":116,"index":29}},{"middle":{"x":4,"y":160},"from":{"x":4,"y":116,"index":26},"to":{"x":-66.95,"y":158,"index":30}},{"middle":{"x":4,"y":160},"from":{"x":4,"y":116,"index":26},"to":{"x":75,"y":158,"index":31}},{"middle":{"x":146,"y":160},"from":{"x":146,"y":116,"index":27},"to":{"x":75,"y":158,"index":31}},{"middle":{"x":146,"y":160},"from":{"x":146,"y":116,"index":27},"to":{"x":216.9,"y":158,"index":32}},{"middle":{"x":287.9,"y":160},"from":{"x":287.9,"y":116,"index":28},"to":{"x":216.9,"y":158,"index":32}},{"middle":{"x":287.9,"y":160},"from":{"x":287.9,"y":116,"index":28},"to":{"x":358.8,"y":158,"index":33}},{"middle":{"x":429.8,"y":160},"from":{"x":429.8,"y":116,"index":29},"to":{"x":358.8,"y":158,"index":33}},{"middle":{"x":429.8,"y":160},"from":{"x":429.8,"y":116,"index":29},"to":{"x":500.75,"y":158,"index":34}},{"middle":{"x":-66.95,"y":240},"from":{"x":-66.95,"y":158,"index":30},"to":{"x":-66.95,"y":240,"index":35}},{"middle":{"x":75,"y":240},"from":{"x":75,"y":158,"index":31},"to":{"x":75.05,"y":240,"index":36}},{"middle":{"x":216.9,"y":240},"from":{"x":216.9,"y":158,"index":32},"to":{"x":216.95,"y":240,"index":37}},{"middle":{"x":358.8,"y":240},"from":{"x":358.8,"y":158,"index":33},"to":{"x":358.85,"y":240,"index":38}},{"middle":{"x":500.75,"y":240},"from":{"x":500.75,"y":158,"index":34},"to":{"x":500.75,"y":240,"index":39}},{"middle":{"x":-66.95,"y":280},"from":{"x":-66.95,"y":240,"index":35},"to":{"x":-137.9,"y":282,"index":40}},{"middle":{"x":-66.95,"y":280},"from":{"x":-66.95,"y":240,"index":35},"to":{"x":4.049999999999997,"y":282,"index":41}},{"middle":{"x":75.05,"y":280},"from":{"x":75.05,"y":240,"index":36},"to":{"x":4.049999999999997,"y":282,"index":41}},{"middle":{"x":75.05,"y":280},"from":{"x":75.05,"y":240,"index":36},"to":{"x":145.95,"y":282,"index":42}},{"middle":{"x":216.95,"y":280},"from":{"x":216.95,"y":240,"index":37},"to":{"x":145.95,"y":282,"index":42}},{"middle":{"x":216.95,"y":280},"from":{"x":216.95,"y":240,"index":37},"to":{"x":287.85,"y":282,"index":43}},{"middle":{"x":358.85,"y":280},"from":{"x":358.85,"y":240,"index":38},"to":{"x":287.85,"y":282,"index":43}},{"middle":{"x":358.85,"y":280},"from":{"x":358.85,"y":240,"index":38},"to":{"x":429.75,"y":282,"index":44}},{"middle":{"x":500.75,"y":280},"from":{"x":500.75,"y":240,"index":39},"to":{"x":429.75,"y":282,"index":44}},{"middle":{"x":500.75,"y":280},"from":{"x":500.75,"y":240,"index":39},"to":{"x":571.7,"y":282,"index":45}},{"middle":{"x":-137.9,"y":360},"from":{"x":-137.9,"y":282,"index":40},"to":{"x":-137.9,"y":364,"index":46}},{"middle":{"x":4.049999999999997,"y":360},"from":{"x":4.049999999999997,"y":282,"index":41},"to":{"x":4.099999999999994,"y":364,"index":47}},{"middle":{"x":145.95,"y":360},"from":{"x":145.95,"y":282,"index":42},"to":{"x":146,"y":364,"index":48}},{"middle":{"x":287.85,"y":360},"from":{"x":287.85,"y":282,"index":43},"to":{"x":287.9,"y":364,"index":49}},{"middle":{"x":429.75,"y":360},"from":{"x":429.75,"y":282,"index":44},"to":{"x":429.8,"y":364,"index":50}},{"middle":{"x":571.7,"y":360},"from":{"x":571.7,"y":282,"index":45},"to":{"x":571.7,"y":364,"index":51}},{"middle":{"x":-137.9,"y":410},"from":{"x":-137.9,"y":364,"index":46},"to":{"x":-66.9,"y":406,"index":52}},{"middle":{"x":4.099999999999994,"y":410},"from":{"x":4.099999999999994,"y":364,"index":47},"to":{"x":-66.9,"y":406,"index":52}},{"middle":{"x":4.099999999999994,"y":410},"from":{"x":4.099999999999994,"y":364,"index":47},"to":{"x":75,"y":406,"index":53}},{"middle":{"x":146,"y":410},"from":{"x":146,"y":364,"index":48},"to":{"x":75,"y":406,"index":53}},{"middle":{"x":146,"y":410},"from":{"x":146,"y":364,"index":48},"to":{"x":216.9,"y":406,"index":54}},{"middle":{"x":287.9,"y":410},"from":{"x":287.9,"y":364,"index":49},"to":{"x":216.9,"y":406,"index":54}},{"middle":{"x":287.9,"y":410},"from":{"x":287.9,"y":364,"index":49},"to":{"x":358.8,"y":406,"index":55}},{"middle":{"x":429.8,"y":410},"from":{"x":429.8,"y":364,"index":50},"to":{"x":358.8,"y":406,"index":55}},{"middle":{"x":429.8,"y":410},"from":{"x":429.8,"y":364,"index":50},"to":{"x":500.7,"y":406,"index":56}},{"middle":{"x":571.7,"y":410},"from":{"x":571.7,"y":364,"index":51},"to":{"x":500.7,"y":406,"index":56}},{"middle":{"x":-66.9,"y":490},"from":{"x":-66.9,"y":406,"index":52},"to":{"x":-66.95,"y":488,"index":57}},{"middle":{"x":75,"y":490},"from":{"x":75,"y":406,"index":53},"to":{"x":75.05,"y":488,"index":58}},{"middle":{"x":216.9,"y":490},"from":{"x":216.9,"y":406,"index":54},"to":{"x":216.95,"y":488,"index":59}},{"middle":{"x":358.8,"y":490},"from":{"x":358.8,"y":406,"index":55},"to":{"x":358.85,"y":488,"index":60}},{"middle":{"x":500.7,"y":490},"from":{"x":500.7,"y":406,"index":56},"to":{"x":500.75,"y":488,"index":61}},{"middle":{"x":-66.95,"y":530},"from":{"x":-66.95,"y":488,"index":57},"to":{"x":4.049999999999997,"y":528,"index":62}},{"middle":{"x":75.05,"y":530},"from":{"x":75.05,"y":488,"index":58},"to":{"x":4.049999999999997,"y":528,"index":62}},{"middle":{"x":75.05,"y":530},"from":{"x":75.05,"y":488,"index":58},"to":{"x":145.95,"y":528,"index":63}},{"middle":{"x":216.95,"y":530},"from":{"x":216.95,"y":488,"index":59},"to":{"x":145.95,"y":528,"index":63}},{"middle":{"x":216.95,"y":530},"from":{"x":216.95,"y":488,"index":59},"to":{"x":287.85,"y":528,"index":64}},{"middle":{"x":358.85,"y":530},"from":{"x":358.85,"y":488,"index":60},"to":{"x":287.85,"y":528,"index":64}},{"middle":{"x":358.85,"y":530},"from":{"x":358.85,"y":488,"index":60},"to":{"x":429.75,"y":528,"index":65}},{"middle":{"x":500.75,"y":530},"from":{"x":500.75,"y":488,"index":61},"to":{"x":429.75,"y":528,"index":65}},{"middle":{"x":4.049999999999997,"y":610},"from":{"x":4.049999999999997,"y":528,"index":62},"to":{"x":4,"y":612,"index":66}},{"middle":{"x":145.95,"y":610},"from":{"x":145.95,"y":528,"index":63},"to":{"x":146,"y":612,"index":67}},{"middle":{"x":287.85,"y":610},"from":{"x":287.85,"y":528,"index":64},"to":{"x":287.9,"y":612,"index":68}},{"middle":{"x":429.75,"y":610},"from":{"x":429.75,"y":528,"index":65},"to":{"x":429.8,"y":612,"index":69}},{"middle":{"x":4,"y":650},"from":{"x":4,"y":612,"index":66},"to":{"x":75,"y":652,"index":70}},{"middle":{"x":146,"y":650},"from":{"x":146,"y":612,"index":67},"to":{"x":75,"y":652,"index":70}},{"middle":{"x":146,"y":650},"from":{"x":146,"y":612,"index":67},"to":{"x":216.9,"y":652,"index":71}},{"middle":{"x":287.9,"y":650},"from":{"x":287.9,"y":612,"index":68},"to":{"x":216.9,"y":652,"index":71}},{"middle":{"x":287.9,"y":650},"from":{"x":287.9,"y":612,"index":68},"to":{"x":358.8,"y":652,"index":72}},{"middle":{"x":429.8,"y":650},"from":{"x":429.8,"y":612,"index":69},"to":{"x":358.8,"y":652,"index":72}}]')},8482:(e,t,i)=>{"use strict";i.d(t,{g:()=>h,io:()=>u});var n,s,o,a,r=i(4196),d=i(7350),l=i(6463),x=i(278);let c=e=>(0,x.Kc)(e),m=e=>(0,x.UD)(e,{to:"string"}),y={debug:null!=(n=l.A.PEER_DEBUG_LEVEL)?n:0,secure:null!=(s=l.A.PEER_SECURE)&&s,port:null!=(o=l.A.PEER_SERVER_PORT)?o:443,host:null!=(a=l.A.PEER_SERVER_HOST)?a:void 0};function u(e){return new Promise((t,i)=>{let n=new r.Ay(y);n.on("open",s=>{let o=n.connect(e,{reliable:!0});setTimeout(()=>{i("the server took too long to respond")},5e3),o.on("open",()=>{let e=new f(o);e.id=s,t(e)}),o.on("error",e=>{i(e.message)})}),n.on("error",e=>{i(e)})})}class f{middleware(e){this.client.on("data",e)}on(e,t){this.events.set(e,t)}emit(e,t){try{this.client.send(c(JSON.stringify({event:e,args:null!=t?t:void 0})))}catch(e){}}disconnect(){this.emit("disconnect"),setTimeout(()=>{this.client.close()},500)}constructor(e){this.id="",this.client=e,this.events=new Map,this.client.on("data",e=>{try{let t=JSON.parse(m(e)),i=this.events.get(t.event);void 0!==i&&i(t.args)}catch(e){}}),this.client.on("error",e=>{console.error("Data connection error:",e)}),this.client.on("close",()=>{try{let e=this.events.get("disconnect");void 0!==e&&e("")}catch(e){}})}}class h{set OnLogs(e){this.logFunction=e}RenderLogs(e){this.renderFunction=e,e(this.logs)}stop(){this.socket.destroy()}constructor(e,t){var i,n=this;this.logs=[];for(var s=!0,o="";s;)try{o=(0,d.a)(),i=new r.Ay((0,d._)(o),y),s=!1}catch(e){s=!0}this.code=o,this.socket=i,this.logFunction=function(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];n.logs.push(t),n.renderFunction(n.logs)},this.renderFunction=()=>{},this.socket.on("open",async()=>{null==e||e(this)}),this.socket.on("connection",e=>{e.on("open",()=>{let i=new f(e);i.id=e.peer,null==t||t(i,this)})})}}},9333:(e,t,i)=>{"use strict";i.d(t,{A:()=>s});let n=e=>({sameSize:{add:t=>(t.forEach((t,i)=>{e[i]+=t}),n([...e])),sub:t=>(t.forEach((t,i)=>{e[i]-=t}),n([...e])),mul:t=>(t.forEach((t,i)=>{e[i]*=t}),n([...e])),div:t=>(t.forEach((t,i)=>{e[i]/=t}),n([...e]))},numeric:{add:t=>(e.forEach((i,n)=>{e[n]+=t}),n([...e])),sub:t=>(e.forEach((i,n)=>{e[n]-=t}),n([...e])),mul:t=>(e.forEach((i,n)=>{e[n]*=t}),n([...e])),div:t=>(e.forEach((i,n)=>{e[n]/=t}),n([...e]))},countpicks:function(t){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;t.forEach(t=>e[t]+=i)},clone:()=>n([...e]),get:()=>e,sum:()=>0===e.length?0:1===e.length?e[0]:e.reduce((e,t)=>e+t),avg(){return this.sum()/e.length},available(e){return this.clone().sameSize.sub(e).get().every(e=>e>=0)},max:()=>0===e.length?0:1===e.length?e[0]:e.reduce((e,t)=>Math.max(e,t)),min:()=>0===e.length?0:1===e.length?e[0]:e.reduce((e,t)=>Math.min(e,t)),maxIndex(){return e.indexOf(this.max())},minIndex(){return e.indexOf(this.max())},counts:t=>0===e.length?0:1===e.length?+(e[0]===t):e.map(e=>+(e===t)).reduce((e,t)=>e+t)}),s=n}}]);